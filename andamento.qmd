---
title: "Andamento do Curso"
lang: "pt-BR"
format:
  html
  
---

Acompanhe o andamento do  **<i class="fa-brands fa-r-project"></i>  Curso de Estat√≠stica com R para Experimenta√ß√£o Agr√≠cola**.


## Aulas ministradas

Acompanhe o andamento das aulas minitradas no curso.

As aulas foram estruturadas de forma progressiva, para que cada etapa sirva de base para a seguinte.

```{r}
#| echo: false
#| message: false
#| warning: false

# Carregar pacotes necess√°rios
library(readxl)
library(dplyr)
library(kableExtra)
library(lubridate)
library(hms)
library(stringr)


aulas_ministradas <- read_excel("banco_dados/aulas_ministradas.xlsx", 
    sheet = "Plan1")

```


```{r}
#| echo: false
# Mostrar tabela estilizada no estilo do site
aulas_ministradas |>
  mutate(
    Data = format(Data, "%d/%b/%Y", locale = "pt_BR.UTF-8"),
    `Hor√°rio de n√≠cio da aula` = format(`Hor√°rio de n√≠cio da aula`, "%H:%M"),
    `Hor√°rio de fim da aula`    = format(`Hor√°rio de fim da aula`, "%H:%M"),
    `N√∫mero de horas` = round(`N√∫mero de horas`,2)
  ) |> 
  kable(
    caption = "Aulas ministradas no Curso de Estat√≠stica com R para Experimenta√ß√£o Agr√≠cola.",
    format = "html",
    table.attr = "class='styled-table'"
  ) |> 
  kable_styling(
    html_font = "Arial",
    full_width = TRUE,
    position = "center"
    )

```






## Script do curso

Baixe o script do curso e treine a progrma√ß√£o em [<i class="fa-brands fa-r-project"></i> utilizando o RStudio.

<p>
Curso: Curso de Estat√≠stica com R para Experimenta√ß√£o Agr√≠cola  
Autor: DSc. Marlenildo Ferreira Melo  
Data: 03 de setembro de 2025  
</p>

[<i class="fa-solid fa-download"></i> Baixar script_cursoder.R](logo_script/script_cursoder.R){.btn .btn-primary download="script_cursoder.R"}

[<i class="fa-brands fa-github"></i> Ver no GitHub](https://github.com/Marlenildo/site/blob/main/logo_script/script_cursoder.R){.btn .btn-dark target="_blank"}


```{r eval=FALSE}
#| echo: true        # mostra o c√≥digo
#| code-fold: true   # permite recolher/expandir
#| code-summary: "Mostrar/Ocultar script"  # texto do bot√£o

#' SCRIPT PARA AN√ÅLISE DE DADOS EXPERIMENTAIS EM R
#' 
#' Curso: [Curso de Estat√≠stica com R para Experimenta√ß√£o Agr√≠cola]
#' Autor: [DSc. Marlenildo Ferreira Melo]
#' Data: [03 de setembro de 2025]
#' Vers√£o do R: [R version 4.5.1 (2025-06-13 ucrt)]
#' Vers√£o do RStudio: [2025.05.1 Build 513]
#' 
#' Objetivo: An√°lise de dados experimentais utilizando pacotes espec√≠ficos em R
#' Descri√ß√£o: Este script cobre desde a instala√ß√£o e carregamento de pacotes,
#' importa√ß√£o e organiza√ß√£o de dados, at√© a realiza√ß√£o de an√°lises estat√≠sticas
#' como estat√≠sticas descritivas e an√°lise de vari√¢ncia (ANOVA).
#' Requisitos: R e RStudio instalados, pacotes necess√°rios instalados


#' ============================================================================
# Aula 1. Introdu√ß√£o ao R e Rstudio----
#' ===========================================================================
#' Data: [03/set/2025]
#'
## 1.1 Primeiros passos----
#' Instala√ß√£o e atualiza√ß√£o do R;
#' Instala√ß√£o e atualiza√ß√£o do RStudio;
#' Apresenta√ß√£o da interface do RStudio;
#' Cria√ß√£o e salvamento do primeiro script;
#'
## 1.2. Diret√≥rio de trabalho----
#' Defini√ß√£o do diret√≥rio de trabalho (working directory) 
#' Defina o diret√≥rio de trabalho para o local onde seus arquivos est√£o armazenados.
#' Altere o caminho abaixo para o diret√≥rio desejado no seu computador.
#' Exemplo de caminho no Windows: ("C:/Users/SeuUsuario/Documentos/ProjetoR")
#' Use barras normais (/) ou duplas (\\) no Windows

setwd("C:/Users/marle/OneDrive/Documentos/Projetos R/site/logo_script")
setwd("C:\\Users\\marle\\OneDrive\\Documentos\\Projetos R\\site\\logo_script")
getwd() # Verifica o diret√≥rio de trabalho atual


#' ============================================================================
# Aula 2. Conhecendo o RStudio----
#' ============================================================================
#' Data: [04/set/2025]
#'
## 2.1 Conhecendo os pa√≠ne√≠s do RStudio
#' Console , Editor/Script; Environment/History; Files/Plots/Packages/Help/Viewer);
#' Comparar a diferen√ßa entre escrever direto no Console e salvar no Script;
#'
## 2.2 Reconhecendo tipos de vari√°veis
#' Reconhecendo os tipos de vari√°veis no Excel:
#' num√©ricas (cont√≠nuas, discretas)
#' categ√≥ricas (nominal e ordinal, fatores)
#' texto livre
#' data
#' l√≥gica (*boolean*) (VERDADEIRO/FALSO)


#' ============================================================================
# Aula 3. Instalando e carregando pacotes no R----
#' ============================================================================
#' Data: [10/set/2025]

## 3.1 Instalando pacotes----

### 3.1.1 Instala√ß√£o individual de pacotes----
install.packages("tidyverse")   # Para manipula√ß√£o e visualiza√ß√£o de dados
install.packages("dplyr")       # Para manipula√ß√£o e visualiza√ß√£o de dados
install.packages("readxl")      # Para ler arquivos do Excel
install.packages("ExpDes.pt")   # Para planejamento e an√°lise de experimentos agr√≠colas
install.packages("easyanova")   # Para facilitar an√°lises de vari√¢ncia
install.packages("rstatix")     # Para estat√≠sticas descritivas e testes inferenciais
install.packages("emmeans")     # Para estat√≠sticas descritivas e testes inferenciais
install.packages("janitor")     # Para limpeza e organiza√ß√£o de dados
install.packages("kableExtra")  # Para tabelas formatadas

### 3.1.2 Instalando pacotes de uma vez s√≥----
install.packages(
  "tidyverse",
  "readxl",
  "ExpDes.pt",
  "easyanova",
  "rstatix",
  "emmeans",
  "janitor",
  "kableExtra"
)

## 3.2 Carregando pacotes----

#' Pacotes para manipula√ß√£o e leitura de dados
library(tidyverse)   # Inclui dplyr, ggplot2, readr, tidyr, etc.
library(dplyr)       # Manipula√ß√£o de dados
library(readxl)      # Para importar planilhas Excel
library(readr)       # Para importar arquivos de texto

#' Pacotes para an√°lise de experimentos
library(ExpDes.pt)   # ANOVA para DIC, DBC, parcelas subdivididas etc.
library(easyanova)   # ANOVA e testes complementares de forma simplificada

#' Pacotes para estat√≠stica e p√≥s-testes
library(rstatix)     # Testes estat√≠sticos (normalidade, homogeneidade, etc.)
library(emmeans)     # M√©dias ajustadas e compara√ß√µes m√∫ltiplas

#' Pacotes para organiza√ß√£o e visualiza√ß√£o de dados
library(janitor)     # Limpeza e organiza√ß√£o de dados
library(kableExtra)  # Tabelas formatadas

## 3.3 Importando dados ara o R----

### 3.3.1 Importando dados de um arquivo Excel usando pacote readxl----
dados_ruins_dic <- read_excel("C:\\Users\\marle\\OneDrive\\Documentos\\Projetos R\\site\\banco_dados\\dados_ruins_dic.xlsx", sheet = "Planilha1")

### 3.3.2 Importando dados de um arquivo .txt (arquivo de texo bloco de notas) usando pacote readr----
dados_ruins_dic <- read_delim("C:\\Users\\marle\\OneDrive\\Documentos\\Projetos R\\site\\banco_dados\\dados_ruins_dic.txt", 
                              delim = "\t", escape_double = FALSE, 
                              trim_ws = TRUE)



dados_ruins_dic # Visualiza√ß√£o r√°pida no console

View(dados_ruins_dic) # Visualiza√ß√£o em uma aba separada
#' ============================================================================
# 5. Renomear colunas espec√≠ficas----
#' ============================================================================

## 5.1 Usando pacote dplyr----
dados_organizados_dplyr <- dados_ruins_dic |>
  rename(
    tratamento = Tratamento,
    repeticao = `Repeti√ß√£o`,
    altura_planta_cm = `Altura da planta (cm)`,
    peso_fresco_g = `Peso fresco (g)`
  )

dados_organizados_dplyr

## 5.2 Usando pacote janitor----
#' formato "snake_case"

dados_organizados_janitor <- dados_ruins_dic |>
  janitor::clean_names()

dados_organizados_janitor


#' ============================================================================
# 6. Visualizando os dados----
#' ============================================================================

## 6.1 Visualiza√ß√£o dos dados originais----

dados_organizados_janitor # Visualiza√ß√£o r√°pida no console
View(dados_organizados_janitor) # Visualiza√ß√£o em uma aba separada (Atalho F2)
head(dados_organizados_janitor) # Primeiras linhas dos dados
tail(dados_organizados_janitor) # √öltimas linhas dos dados
names(dados_organizados_janitor) # Nomes das colunas

## 6.2 Visualiza√ß√£o da estrutura dos dados e resumo estat√≠stico----

str(dados_organizados_janitor) # Estrutura dos dados
glimpse(dados_organizados_janitor) # Vis√£o geral dos dados (dplyr)
summary(dados_organizados_janitor) # Resumo estat√≠stico dos dados

  
#' ============================================================================
# 7. Convertendo vari√°veis em fatores----
#' ===========================================================================
  
## 7.1 Usando a fun√ß√£o `as.factor()`----
  
dados_organizados_janitor$tratamento <- as.factor(dados_organizados_janitor$tratamento)
dados_organizados_janitor$repeticao <- as.factor(dados_organizados_janitor$repeticao)
  
  
str(dados_organizados_janitor) # Estrutura dos dados
glimpse(dados_organizados_janitor) # Vis√£o geral dos dados (dplyr)
summary(dados_organizados_janitor) # Resumo estat√≠stico dos dados
  
##' 7.2 Usando a fun√ß√£o `convert_as_factor` do pacote rstatix----
  
dados_organizados_janitor <- dados_organizados_janitor |>
  convert_as_factor(tratamento, repeticao)
  
  
str(dados_organizados_janitor) # Estrutura dos dados
glimpse(dados_organizados_janitor) # Vis√£o geral dos dados (dplyr)
summary(dados_organizados_janitor) # Resumo estat√≠stico dos dados


#' ============================================================================
# 8. Conhecendo os tipos de vari√°veis no R----
#' ============================================================================

#' Exemplo de banco de dados com todos os tipos de vari√°veis
#'   em experimenta√ß√£o agr√≠cola (Delineamento em Blocos Casualizados)
dados_tipos <- read_excel("dados_tipos.xlsx", sheet = "Planilha1")

  
# Conferindo estrutura e resumo do banco
str(dados_tipos)          # Estrutura das vari√°veis
glimpse(dados_tipos)      # Vis√£o geral das vari√°veis com dplyr
summary(dados_tipos)      # Resumo estat√≠stico dos dados
  
  
# Renomeando colunas para facilitar o manuseio  
dados_tipos_organizado <- dados_tipos |>
    janitor::clean_names()

# Visualizando parte do banco
head(dados_tipos_organizado) |> view()


#' EXPLICA√á√ÉO DOS TIPOS DE VARI√ÅVEIS

#' 1) bloco -> Vari√°vel num√©rica inteira (discreta)
#' Representa os blocos do experimento (repeti√ß√µes). √â usada para controlar
#' a variabilidade do campo. No R, aparece como "numeric" (ou "integer").

#' 2) tipo_adubo -> Vari√°vel de texto (character), pode ser transformada em fator
#' Representa a descri√ß√£o do tratamento aplicado.
#' Exemplo: "Testemunha", "Adubo verde".

#' 3) tratamento -> Vari√°vel categ√≥rica nominal (factor)
#' √â o identificador do tratamento (T1, T2, ...).
#' N√£o tem ordem l√≥gica, apenas categorias distintas.

#' 4) data_coleta -> Vari√°vel do tipo Date
#' Representa a data em que os dados foram coletados.

#' 5) nota_vigor -> Vari√°vel ordinal
#' Escala de 1 a 5 indicando o vigor da planta.
#' Existe uma ordem (1 < 2 < 3 < 4 < 5).

#' 6) numero_folhas -> Vari√°vel num√©rica inteira (discreta)
#' Conta o n√∫mero de folhas da planta.
#' S√≥ assume valores inteiros (5, 6, 7...).

#' 7) altura_cm -> Vari√°vel num√©rica cont√≠nua
#' Medida da altura em cent√≠metros.
#' Pode assumir qualquer valor real dentro de um intervalo.

#' 8) sobreviveu -> Vari√°vel l√≥gica (boolean)
#' Indica se a planta sobreviveu (TRUE) ou morreu (FALSE).

#' 9) observacao -> Vari√°vel categ√≥rica nominal
#' Anota√ß√µes pr√©-definidas sobre a planta: "Normal", "Doen√ßa", "Atraso".
#' N√£o existe ordem entre as categorias.

#' 10) comentario_livre -> Vari√°vel de texto livre (character)
#' Coment√°rios mais detalhados feitos pelo avaliador.
#' Exemplo: "Necessita irriga√ß√£o extra", "Presen√ßa de pragas".

#' ============================================================================
# 9. Convertendo vari√°veis em fatores no banco 'dados_tipos' ----
#' ============================================================================

# Carregando pacote necess√°rio
library(rstatix)
library(dplyr)

## 9.1 Usando a fun√ß√£o `as.factor()` ----

# Convertendo vari√°veis categ√≥ricas para fator
dados_tipos_organizado$tipo_de_adubo <- as.factor(dados_tipos_organizado$tipo_de_adubo)
dados_tipos_organizado$tratamento <- as.factor(dados_tipos_organizado$tratamento)
dados_tipos_organizado$observacao <- as.factor(dados_tipos_organizado$observacao)
dados_tipos_organizado$bloco <- as.factor(dados_tipos_organizado$bloco) # opcional: bloco tamb√©m como fator

# Conferindo estrutura e resumo do banco
str(dados_tipos_organizado)          # Estrutura das vari√°veis
glimpse(dados_tipos_organizado)      # Vis√£o geral das vari√°veis com dplyr
summary(dados_tipos_organizado)      # Resumo estat√≠stico dos dados

#' Estrutura geral do banco
dados_tipos_organizado |> view() # com v min√∫sculo - Visualiza√ß√£o em uma aba separada (Atalho F2)
dados_tipos_organizado |> View() # com v mai√∫sculo - Visualiza√ß√£o em uma aba separada (Atalho F2)
dados_tipos_organizado |>  str() # Estrutura das vari√°veis
dados_tipos_organizado |> glimpse() # Vis√£o geral dos dados (dplyr)
dados_tipos_organizado |> summary() # Resumo estat√≠stico dos dados



## 9.2 Usando a fun√ß√£o `convert_as_factor()` do pacote rstatix ----

# Convers√£o das vari√°veis categ√≥ricas para fatores de forma mais pr√°tica
dados_tipos <- dados_tipos %>%
  convert_as_factor(tipo_adubo, tratamento, observacao, bloco)

# Conferindo novamente
str(dados_tipos)          # Estrutura das vari√°veis
glimpse(dados_tipos)      # Vis√£o geral com dplyr
summary(dados_tipos)      # Resumo estat√≠stico


#' ============================================================================
# 10. Estat√≠sticas descritivas----
#' ===========================================================================

## 10.1 Estat√≠sticas descritivas gerais usando pacote dplyr----

#' M√©dia geral
dados_organizados_janitor |>
  summarise(
    n = n(),  # Contagem total de observa√ß√µes
    media_altura = mean(altura_da_planta_cm, na.rm = TRUE),  # M√©dia da altura
    sd_altura = sd(altura_da_planta_cm, na.rm = TRUE),      # Desvio padr√£o da altura
    media_peso = mean(peso_fresco_g, na.rm = TRUE),      # M√©dia do peso fresco
    sd_peso = sd(peso_fresco_g, na.rm = TRUE)           # Desvio padr√£o do peso fresco
  )

#' M√©dia por tratamento
dados_organizados_janitor |>
  group_by(tratamento) |>  # Agrupa por tratamento
  summarise(
    n = n(),  # Contagem total de observa√ß√µes
    media_altura = mean(altura_da_planta_cm, na.rm = TRUE),  # M√©dia da altura
    sd_altura = sd(altura_da_planta_cm, na.rm = TRUE),      # Desvio padr√£o da altura
    media_peso = mean(peso_fresco_g, na.rm = TRUE),      # M√©dia do peso fresco
    sd_peso = sd(peso_fresco_g, na.rm = TRUE)           # Desvio padr√£o do peso fresco
  )

## 10.2 Estat√≠sticas descritivas usando pacote rstatix----

#' Estat√≠sticas descritivas gerais *m√©dia e desvio-padr√£o*
dados_organizados_janitor |>
  rstatix::get_summary_stats(altura_da_planta_cm, peso_fresco_g, type = "mean_sd")

#' Estat√≠sticas descritivas por tratamento *m√©dia e desvio-padr√£o*
dados_organizados_janitor |>
  group_by(tratamento) |>  # Agrupa por tratamento
  rstatix::get_summary_stats(altura_da_planta_cm, peso_fresco_g, type = "mean_sd")

#' Estat√≠sticas descritivas por tratamento *m√©dia e erro-padr√£o*
dados_organizados_janitor |>
  group_by(tratamento) |>  # Agrupa por tratamento
  rstatix::get_summary_stats(altura_da_planta_cm, peso_fresco_g, type = "mean_se")

#' Estat√≠sticas descritivas completas por tratamento
dados_organizados_janitor |>
  group_by(tratamento) |>  # Agrupa por tratamento
  rstatix::get_summary_stats(altura_da_planta_cm, peso_fresco_g)




#' ============================================================================
# 11. An√°lise de vari√¢ncia (ANOVA)----
#' ===========================================================================

## 11.1 Usando a fun√ß√£o `aov()`----
modelo <- aov(altura_da_planta_cm  ~ tratamento, data = dados_organizados_janitor)
summary(modelo)

## 11.2 Usando a fun√ß√£o `anova_test` do pacote rstatix----
dados_organizados_janitor |> anova_test(altura_da_planta_cm ~ tratamento) 


## 11.3 Usando a fun√ß√£o `dic()` do pacote ExpDes.pt----

dic(
  trat = dados_organizados_janitor$tratamento,
  resp = dados_organizados_janitor$altura_da_planta_cm,
  quali = TRUE,
  mcomp = "tukey"
)

## 11.4 Usando a fun√ß√£o `ea1` do pacote easyanova----
easyanova::ea1(dados_organizados_janitor[-2], design = 1, plot = 2, list = TRUE)

## 11.5 Usando o pacote easyanova (ANOVA)----


## 11.6 Usando o pacote ExpDes.pt (DIC)----

#' ANOVA para DIC
#' O pacote ExpDes.pt √© espec√≠fico para experimentos agr√≠colas
#' e facilita a an√°lise de delineamentos experimentais comuns.
#' Ele √© especialmente √∫til para an√°lises de vari√¢ncia (ANOVA)
#' em delineamentos inteiramente casualizados (DIC),
#' delineamentos em blocos casualizados (DBC),
#' parcelas subdivididas, entre outros.
#' Ele tamb√©m oferece fun√ß√µes para realizar testes complementares,
#' como o teste de Tukey, e para gerar gr√°ficos b√°sicos.
#' #' A fun√ß√£o `dic()` do pacote ExpDes.pt √© usada para realizar a an√°lise de vari√¢ncia (ANOVA)
#' em um delineamento inteiramente casualizado (DIC).
#' Ela calcula a ANOVA para uma vari√°vel resposta em fun√ß√£o de um fator de tratamento,
#' considerando as repeti√ß√µes do experimento.
#' #' A fun√ß√£o tamb√©m pode realizar testes complementares, como o teste de Tukey,
#' para comparar as m√©dias dos tratamentos.
#' #' A sintaxe b√°sica da fun√ß√£o `dic()` √© a seguinte:
#' #' ```R
#' dic(response, treatment, block = NULL, quali = NULL, mcomp = "tukey", sigT = 0.05, sigF = 0.05, group = TRUE, console = TRUE)
#' 
#' 





#'  ============================================================================
#'  Fim do Script
#'  ============================================================================

```


<br>

## Fa√ßa as atividades propostas

<h4 style="color: var(--secondary-color); font-weight:bold;"> Desafios e exerc√≠cios √† frente! </h4>

Desenvolva as atividades a seguir e fortale√ßa suas habilidades em R.



### Atividade 1

Nesta atividade voc√™ dever√° **buscar um banco de dados**, exportar para o **Excel** e, dentro do Excel, identificar os tipos de vari√°veis.

1.  Procure e selecione um banco de dados (de sites abertos ou de outra fonte confi√°vel).\
2.  Exporte o banco de dados para o Excel (formato `.xlsx`).\
3.  Abra o banco no **Excel**.\
4.  Analise cada coluna e classifique o **tipo de vari√°vel**:
    -   Num√©rica (valores inteiros ou decimais)\
    -   Texto / Caractere (nomes, palavras, descri√ß√µes)\
    -   L√≥gica (valores **Verdadeiro/Falso** ou **Sim/N√£o**)\
    -   Categ√≥rica / Fator (classes ou categorias, como tratamentos, cidades, esp√©cies etc.)\
5.  Crie uma **tabela resumo** no Excel com as seguintes colunas:
    -   Nome da vari√°vel\
    -   Tipo identificado\
    -   Justificativa (por que √© desse tipo)

> üëâ Essa atividade vai treinar a **percep√ß√£o dos diferentes tipos de vari√°veis** e a **organiza√ß√£o de informa√ß√µes em planilhas**.



